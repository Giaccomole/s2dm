{{- $src := .Get "src" -}}
{{- $height := .Get "height" | default "600px" -}}
{{- $title := .Get "title" | default "API Documentation" -}}
{{- $id := .Get "id" | default (printf "xyd-%d" (now.Unix)) -}}
{{- $responsive := .Get "responsive" | default "true" -}}

<div class="xyd-embed-container" data-responsive="{{ $responsive }}">
  {{- if $title -}}
  <div class="xyd-embed-header">
    <h3 class="xyd-embed-title">{{ $title }}</h3>
    <a href="{{ $src }}" target="_blank" class="xyd-embed-external" title="Open in new window">
      <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"></path>
        <polyline points="15,3 21,3 21,9"></polyline>
        <line x1="10" y1="14" x2="21" y2="3"></line>
      </svg>
    </a>
  </div>
  {{- end -}}
  
  <div class="xyd-embed-wrapper">
    <iframe 
      id="{{ $id }}"
      src="{{ $src }}"
      width="100%" 
      height="{{ $height }}"
      frameborder="0"
      sandbox="allow-scripts allow-same-origin allow-forms allow-popups allow-popups-to-escape-sandbox allow-top-navigation-by-user-activation"
      loading="lazy"
      referrerpolicy="strict-origin-when-cross-origin"
      title="{{ $title }}">
      <div class="xyd-embed-fallback">
        <p>Unable to load embedded documentation.</p>
        <a href="{{ $src }}" target="_blank" class="xyd-embed-fallback-link">
          View documentation in new window â†’
        </a>
      </div>
    </iframe>
    
    <div class="xyd-embed-loading">
      <div class="xyd-embed-spinner"></div>
      <p>Loading documentation...</p>
    </div>
  </div>
</div>
